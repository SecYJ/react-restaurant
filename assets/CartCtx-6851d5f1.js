import{r as s,j as p}from"./jsx-runtime-00d1b5d3.js";function y(e,o){const[c,a]=s.useState(()=>{if(typeof window>"u")return o;try{const r=window.localStorage.getItem(e);return r?JSON.parse(r):o}catch(r){return console.log(r),o}});return[c,r=>{try{const t=r instanceof Function?r(c):r;a(t),typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(t))}catch(t){console.log(t)}}]}const T=(e,o)=>{const c=a=>{let n=0,r=0;return a.forEach(({orderQty:t,price:l})=>{n+=Number((t*l).toFixed(2)),r+=t}),{totalAmount:n,totalUnits:r}};switch(o.type){case"SET_CART":{const{payload:a}=o;return{...e,cart:a,...c(a)}}case"ADD_TO_CART":{const{id:a}=o.payload;if(!e.cart.find(t=>t.id===a)){const t=[...e.cart,{...o.payload,orderQty:1}];return{...e,cart:t,...c(t)}}const r=e.cart.map(t=>t.id===a?{...t,orderQty:t.orderQty+1}:t);return{...e,cart:r,...c(r)}}case"TOGGLE_CART_VISIBILITY":return{...e,cartVisible:o.payload};case"REMOVE_CART_ITEM":{const a=e.cart.filter(n=>n.id!==o.payload);return{...e,cart:a,...c(a)}}case"UPDATE_CART_ITEM":{const{direction:a,id:n}=o.payload,r=e.cart.map(t=>{if(t.id!==n)return t;let l;return a==="increment"&&(l=t.orderQty+1),a==="decrement"&&(l=t.orderQty-1),{...t,orderQty:l}});return{...e,cart:r,...c(r)}}case"CLEAR_CART":return{...e,totalAmount:0,totalUnits:0,cart:[]}}return e},u=s.createContext(),f={cart:[],totalAmount:0,totalUnits:0},E=({children:e})=>{const[o,c]=s.useReducer(T,f),[a,n]=y("cart",[]);s.useEffect(()=>{n(o.cart,[])},[o.cart,o.totalAmount,o.totalUnits]),s.useEffect(()=>{c({type:"SET_CART",payload:a})},[]);const r=s.useCallback(({direction:d,id:C})=>{c({type:"UPDATE_CART_ITEM",payload:{direction:d,id:C}})},[]),t=s.useCallback(d=>{c({type:"REMOVE_CART_ITEM",payload:d})},[]),l=s.useCallback(d=>{c({type:"TOGGLE_CART_VISIBILITY",payload:d})},[]),i=s.useCallback(()=>{c({type:"CLEAR_CART"})},[]);return p(u.Provider,{value:{...o,dispatch:c,updateCartItem:r,deleteCartItem:t,toggleCart:l,clearCart:i},children:e})},I=()=>s.useContext(u);export{E as C,I as u};
